select:
  - platform: mitsubishi_itp
    temperature_source:
      name: "Temperature Source"
      id: temperature_source_select
      sources:
      - ${source.internal_id}

sensor:
  - platform: homeassistant
    internal: true
    id: "${source.internal_id}_remote"
    entity_id: "${source.entity_id}"
    filters:
      - lambda: return ((x - 32.0) * (5.0 / 9.0));

  - platform: template
    internal: true
    id: ${source.internal_id}
    name: "${source.name}"
    unit_of_measurement: "Â°C"
    device_class: temperature
    state_class: measurement
    update_interval: 5min
    lambda: |-
      return id(${source.internal_id}_remote).state;

text_sensor:
  - platform: template
    name: "Actual Source"
    update_interval: 5s
    lambda: |-
      if (id(using_internal_temperature_sensor).has_state() && id(using_internal_temperature_sensor).state) {
        return std::string("Internal");
      }

      if (id(temperature_source_select).has_state()) {
        return id(temperature_source_select).state;
      }

      return std::string("Unknown");
